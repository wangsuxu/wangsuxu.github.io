<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An introduction of applestock • applestock</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An introduction of applestock">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">applestock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">An introduction of applestock</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An introduction of applestock</h1>
                        <h4 class="author">Suxu Wang</h4>
            
            <h4 class="date">2018-12-16</h4>
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Applestock is a data package about Apple’s stock price, which records information related to Apple’s stock price since 2007. This packet contains a total of two data sets and two functions. A data set called “adj.price_df” records the daily share price of Apple from 2007 to 2018, in the form of closing prices. At the same time, this data package also records information such as daily trading volume, dividends and so on. Another data packet, productreturn, is a composite data packet. The data of this dataset mainly comes from the adj.price_df dataset we mentioned earlier, which data is downloaded by using API provided by Intrinio, a financial data website. Another data source of productreturn is the wikipedia website, which records the time when all of Apple’s new mobile phone products and new IOS systems were released. The 3 data sources of productretun is listed as follows:</p>
<p>Intrinio: <a href="https://intrinio.com/" class="uri">https://intrinio.com/</a> Wikipedia iPhone: <a href="https://en.wikipedia.org/wiki/IPhone" class="uri">https://en.wikipedia.org/wiki/IPhone</a> wikipedia IOS: <a href="https://en.wikipedia.org/wiki/IOS_version_history" class="uri">https://en.wikipedia.org/wiki/IOS_version_history</a></p>
</div>
<div id="data-package-adj-price_df" class="section level2">
<h2 class="hasAnchor">
<a href="#data-package-adj-price_df" class="anchor"></a>Data package: adj.price_df</h2>
<div id="aapl-stock-closing-price-from-2007-to-2018-and-new-products-released-since-2007" class="section level3">
<h3 class="hasAnchor">
<a href="#aapl-stock-closing-price-from-2007-to-2018-and-new-products-released-since-2007" class="anchor"></a>AAPL stock closing price from 2007 to 2018 and new products released since 2007</h3>
<div id="description" class="section level4">
<h4 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h4>
<p>This data provides AAPL’s stock closing price from 2007 to Dec.14th, 2018 the date that this project is finished. Trading volume every trading day and its dividends are recorded in this dataset as well.</p>
</div>
<div id="obtain-data-from-intrinio-api" class="section level4">
<h4 class="hasAnchor">
<a href="#obtain-data-from-intrinio-api" class="anchor"></a>Obtain data from Intrinio API</h4>
<p>The data collection process is as follow:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Library packages useful in our program. 
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(devtools)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(roxygen2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(testthat)</code></pre></div>
<pre><code>## 
## Attaching package: 'testthat'</code></pre>
<pre><code>## The following objects are masked from 'package:devtools':
## 
##     setup, test_file</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(httr)  
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(jsonlite)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rvest)</code></pre></div>
<pre><code>## Loading required package: xml2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RCurl)</code></pre></div>
<pre><code>## Loading required package: bitops</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(syuzhet)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</code></pre></div>
<pre><code>## -- Attaching packages ------------------------------------------------------------------------------------------------------ tidyverse 1.2.1 --</code></pre>
<pre><code>## v ggplot2 3.1.0     v purrr   0.2.5
## v tibble  1.4.2     v dplyr   0.7.8
## v tidyr   0.8.2     v stringr 1.3.1
## v readr   1.2.1     v forcats 0.3.0</code></pre>
<pre><code>## -- Conflicts --------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
## x tidyr::complete()       masks RCurl::complete()
## x dplyr::filter()         masks stats::filter()
## x purrr::flatten()        masks jsonlite::flatten()
## x readr::guess_encoding() masks rvest::guess_encoding()
## x purrr::is_null()        masks testthat::is_null()
## x dplyr::lag()            masks stats::lag()
## x dplyr::matches()        masks testthat::matches()
## x purrr::pluck()          masks rvest::pluck()</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(stringr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(data.table)</code></pre></div>
<pre><code>## 
## Attaching package: 'data.table'</code></pre>
<pre><code>## The following objects are masked from 'package:dplyr':
## 
##     between, first, last</code></pre>
<pre><code>## The following object is masked from 'package:purrr':
## 
##     transpose</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(purrr)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(gsubfn)</code></pre></div>
<pre><code>## Loading required package: proto</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(proto)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RSQLite)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sqldf)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(knitr)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## The API keys we obtained, we store them and do not post them in the code.
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Rhome">R.home</a></span>(<span class="dt">component =</span> <span class="st">"home"</span>)</code></pre></div>
<pre><code>## [1] "C:/Users/wangs/DOCUME~1/R-35~1.1"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">user_renviron =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/path.expand">path.expand</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/file.path">file.path</a></span>(<span class="st">"~"</span>, <span class="st">".Renviron"</span>))
<span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files">file.exists</a></span>(user_renviron)) <span class="co"># check to see if the file already exists.</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/files">file.create</a></span>(user_renviron)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/file.edit">file.edit</a></span>(user_renviron) <span class="co"># open with another text editor if this fails.</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extract stocks price using Intrinio API.</span>
base &lt;-<span class="st"> "https://api.intrinio.com/"</span>
indicator &lt;-<span class="st"> "prices"</span>
stock &lt;-<span class="st"> "AAPL"</span>
key &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Sys.getenv">Sys.getenv</a></span>(<span class="st">"INTRINIO_USSTOCKPRICE_TOKEN"</span>)
response_price &lt;-<span class="st"> </span><span class="kw">GET</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(base, indicator, <span class="st">"?"</span>, <span class="st">"ticker"</span>, <span class="st">"="</span>, stock, <span class="st">"&amp;frequency=daily"</span>, 
                            <span class="st">"&amp;page_number="</span>, <span class="dv">1</span>, <span class="st">"&amp;api_key"</span>, <span class="st">"="</span>, key, <span class="dt">sep =</span> <span class="st">""</span>),
                      <span class="kw">user_agent</span>(<span class="st">"sw3321@columbia.edu</span>
<span class="st">                                 http://project.github.io"</span>))

<span class="cf">if</span>(<span class="kw">http_error</span>(response_price)) { <span class="co">#Add a checking process to automatically check whether there is an error.</span>
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/warning">warning</a></span>(<span class="st">"Oops! The request produced an error."</span>)
} <span class="cf">else</span> {
  result_price &lt;-<span class="st"> </span><span class="kw">content</span>(response_price, <span class="st">"text"</span>)
  price_json &lt;-<span class="st"> </span><span class="kw">fromJSON</span>(result_price, <span class="dt">flatten =</span> <span class="ot">TRUE</span>)
  price_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(price_json)
  pages &lt;-<span class="st"> </span>price_json<span class="op">$</span>total_pages <span class="co">#Get the number of total pages of this dataframe.</span>
}</code></pre></div>
<pre><code>## No encoding supplied: defaulting to UTF-8.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Obtain the whole dataset acrossing time and pages limits.</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>pages) { <span class="co">#As Intrinio has a limits on pages download for every query, we need to write a code to repeat queries.</span>
  response_price_loop &lt;-<span class="st"> </span><span class="kw">GET</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(base, indicator, <span class="st">"?"</span>, <span class="st">"ticker"</span>, <span class="st">"="</span>, stock, <span class="st">"&amp;frequency=daily"</span>, <span class="st">"&amp;page_number="</span>, i, <span class="st">"&amp;api_key"</span>, <span class="st">"="</span>, key, <span class="dt">sep =</span> <span class="st">""</span>)) 
  result_price_loop &lt;-<span class="st"> </span><span class="kw">content</span>(response_price_loop, <span class="st">"text"</span>)
  price_json_loop &lt;-<span class="st"> </span><span class="kw">fromJSON</span>(result_price_loop, <span class="dt">flatten =</span> <span class="ot">TRUE</span>)
  price_df_loop &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(price_json_loop)
  price_df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(price_df, price_df_loop) <span class="co">#Combine pages downloaded into one dataframe.</span>
}</code></pre></div>
<pre><code>## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.
## No encoding supplied: defaulting to UTF-8.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">startdate &lt;-<span class="st"> "2007-01-03"</span> <span class="co">#For AAPL stock information can be traced back to 1980, which we do not need. Set the starting date for this date.</span>
findstartdaye &lt;-<span class="st"> </span>price_df<span class="op">$</span>data.date <span class="op">==</span><span class="st"> </span>startdate 
rowstartdate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(findstartdaye <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="co">#Check the row that startdate is located.</span>
historicalprice &lt;-<span class="st"> </span>price_df[<span class="dv">1</span><span class="op">:</span>rowstartdate,]</code></pre></div>
</div>
<div id="obtain-data-from-wikipedia-using-web-scraping-techniques" class="section level4">
<h4 class="hasAnchor">
<a href="#obtain-data-from-wikipedia-using-web-scraping-techniques" class="anchor"></a>Obtain data from Wikipedia using web scraping techniques</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Extract Table from HTML
url_wiki &lt;-<span class="st"> "https://en.wikipedia.org/wiki/IPhone"</span>
wiki &lt;-<span class="st"> </span><span class="kw">read_html</span>(url_wiki)
alc_table &lt;-<span class="st"> </span><span class="kw">html_node</span>(<span class="dt">x =</span> wiki, <span class="dt">xpath =</span> <span class="st">"//table[1]"</span>)

## Extract the wiki page title
xpath_sheetname &lt;-<span class="st"> '//*[@id="firstHeading"]'</span>
page_name &lt;-<span class="st"> </span><span class="kw">html_node</span>(<span class="dt">x =</span> wiki, <span class="dt">xpath =</span> xpath_sheetname)
page_title &lt;-<span class="st"> </span><span class="kw">html_text</span>(page_name)
page_title</code></pre></div>
<pre><code>## [1] "iPhone"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Extract the iPhone content
xpath_caption &lt;-<span class="st"> '//*[@id="mw-content-text"]/div/h2[1]'</span>
table_caption_node &lt;-<span class="st"> </span><span class="kw">html_node</span>(<span class="dt">x =</span> alc_table , <span class="dt">xpath =</span> xpath_caption)
table_caption &lt;-<span class="st"> </span><span class="kw">html_text</span>(table_caption_node)
table_caption</code></pre></div>
<pre><code>## [1] "History and availability"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Extract the iPhone table
iphonetime &lt;-<span class="st"> </span>wiki <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">'//*[@id="mw-content-text"]/div/table[3]'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">html_table</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>)

## wrangle the iPhone table
iphonetime[,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/grep">sub</a></span>(<span class="st">"^[^(]*"</span>, <span class="st">""</span>, iphonetime[,<span class="dv">3</span>]))
iphonetime[,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substr">substring</a></span>(iphonetime[,<span class="dv">3</span>], <span class="dv">2</span>, <span class="dv">11</span>))
iphonetime[,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(iphonetime[,<span class="dv">3</span>], <span class="st">"%Y-%m-%d"</span>), <span class="st">"%d-%m-%Y"</span>)
iphonetime &lt;-<span class="st"> </span>iphonetime[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(iphonetime) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"iPhone"</span>, <span class="st">"IOS"</span>, <span class="st">"Release_date"</span>, <span class="st">"FinalOS"</span>, <span class="st">"Warrantyend"</span>, <span class="st">"Warrantylifespan"</span>, <span class="st">"Launchprice"</span>)

## wrangle the iPhone table
price_performance_df &lt;-<span class="st"> </span>iphonetime <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(iPhone, Release_date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">separate</span>(iPhone, <span class="dt">into =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Product"</span>, <span class="st">"Version"</span>), <span class="dt">sep =</span> <span class="st">" "</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(price_performance_df) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>)

## Extract ios Table from HTML
url_wiki_ios &lt;-<span class="st"> "https://en.wikipedia.org/wiki/IOS_version_history"</span>
wiki_ios &lt;-<span class="st"> </span><span class="kw">read_html</span>(url_wiki_ios)

## wrangle the ios table
iostime &lt;-<span class="st"> </span>wiki_ios <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">'//*[@id="mw-content-text"]/div/table[1]'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">html_table</span>(<span class="dt">fill =</span> <span class="ot">TRUE</span>)
iostime &lt;-<span class="st"> </span>iostime[<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">6</span>)]
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(iostime) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>) 
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(iostime) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Version"</span>, <span class="st">"Release_date"</span>)
iostime[<span class="dv">5</span>,<span class="dv">2</span>] &lt;-<span class="st"> "Jun 30, 2014"</span>
iostime[,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(iostime[,<span class="dv">2</span>], <span class="st">"%b %d,%Y"</span>), <span class="st">"%d-%m-%Y"</span>)
iostime &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="dt">Product =</span> <span class="st">"IOS"</span>, iostime)

##rbind iPhone and ios 
product_version &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(price_performance_df, iostime)
<span class="kw">kable</span>(product_version)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">Product</th>
<th align="left">Version</th>
<th align="left">Release_date</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">NA</td>
<td align="left">29-06-2007</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">3G</td>
<td align="left">11-07-2008</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">3GS</td>
<td align="left">19-06-2009</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">4</td>
<td align="left">21-06-2010</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">4S</td>
<td align="left">14-10-2011</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">5</td>
<td align="left">21-09-2012</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">5C</td>
<td align="left">20-09-2013</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">5S</td>
<td align="left">20-09-2013</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">6</td>
<td align="left">19-09-2014</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">6S</td>
<td align="left">25-09-2015</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">SE</td>
<td align="left">31-03-2016</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">7</td>
<td align="left">16-09-2016</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">8</td>
<td align="left">22-09-2017</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">X</td>
<td align="left">03-11-2017</td>
</tr>
<tr class="odd">
<td align="left">iPhone</td>
<td align="left">XS</td>
<td align="left">21-09-2018</td>
</tr>
<tr class="even">
<td align="left">iPhone</td>
<td align="left">XR</td>
<td align="left">26-10-2018</td>
</tr>
<tr class="odd">
<td align="left">IOS</td>
<td align="left">3.1.3</td>
<td align="left">02-02-2010</td>
</tr>
<tr class="even">
<td align="left">IOS</td>
<td align="left">4.2.1</td>
<td align="left">22-11-2010</td>
</tr>
<tr class="odd">
<td align="left">IOS</td>
<td align="left">5.1.1</td>
<td align="left">07-05-2012</td>
</tr>
<tr class="even">
<td align="left">IOS</td>
<td align="left">6.1.6</td>
<td align="left">21-02-2014</td>
</tr>
<tr class="odd">
<td align="left">IOS</td>
<td align="left">7.1.2</td>
<td align="left">30-06-2014</td>
</tr>
<tr class="even">
<td align="left">IOS</td>
<td align="left">9.3.5</td>
<td align="left">25-08-2016</td>
</tr>
<tr class="odd">
<td align="left">IOS</td>
<td align="left">10.3.3</td>
<td align="left">19-07-2017</td>
</tr>
<tr class="even">
<td align="left">IOS</td>
<td align="left">12.1.1</td>
<td align="left">05-12-2018</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Trim the AAPL price data, retaining data since 2007 
adj.price_df &lt;-<span class="st"> </span>price_df <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="dt">date =</span> data.date, <span class="dt">closing.price =</span> data.adj_close, <span class="dt">trading.volume =</span> data.adj_volume, <span class="dt">dividend =</span> data.ex_dividend)
adj.price_df<span class="op">$</span>date &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(adj.price_df<span class="op">$</span>date, <span class="st">"%Y-%m-%d"</span>), <span class="st">"%d-%m-%Y"</span>)
adj.price_df<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/substr">substring</a></span>(adj.price_df<span class="op">$</span>date, <span class="dv">7</span>, <span class="dv">10</span>)))
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(adj.price_df)</code></pre></div>
<pre><code>##         date closing.price trading.volume dividend year
## 1 14-12-2018        165.48       40703710        0 2018
## 2 13-12-2018        170.95       31897827        0 2018
## 3 12-12-2018        169.10       35627674        0 2018
## 4 11-12-2018        168.63       47281665        0 2018
## 5 10-12-2018        169.60       62025994        0 2018
## 6 07-12-2018        168.49       42281631        0 2018</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>adj.price_df, <span class="kw">aes</span>(<span class="dt">x=</span>adj.price_df<span class="op">$</span>year, <span class="dt">y=</span>adj.price_df<span class="op">$</span>closing.price, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour=</span><span class="st">"blue"</span>, <span class="dt">size=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data=</span>adj.price_df, <span class="kw">aes</span>(<span class="dt">x=</span>adj.price_df<span class="op">$</span>year, <span class="dt">y=</span>adj.price_df<span class="op">$</span>trading.volume, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">colour=</span><span class="st">"red"</span>, <span class="dt">size=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Write a CSV in R: This code is deleted as we already finished this step. </code></pre></div>
<p>Right now, the original dataframes have been downdoaded and already could be used. We will leave these two datasets for a while, as in the next step, we are going to build two functions, which can be used to make some statistical analysis on the adj.price_df dataset and calculate returns. After building these two functions, we will use them to integrate the profuctreturn dataset, which is a highly wrangled dataset based on adj.price_df and product_version using SQL language.</p>
</div>
</div>
</div>
<div id="function-packages-hppr-and-tdpr" class="section level2">
<h2 class="hasAnchor">
<a href="#function-packages-hppr-and-tdpr" class="anchor"></a>function packages: HPPR and TDPR</h2>
<div id="holding-period-price-return-and-trading-day-price-return" class="section level3">
<h3 class="hasAnchor">
<a href="#holding-period-price-return-and-trading-day-price-return" class="anchor"></a>Holding period price return and Trading day price return</h3>
<div id="hppr" class="section level4">
<h4 class="hasAnchor">
<a href="#hppr" class="anchor"></a>HPPR</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># function_1</span>
<span class="co">#Holding Period Price Return Function</span>
<span class="co">#We are not using "load" function here as we can directly extract data from adj.price_df above, this process of obtaining data is a little bit different from the function in the package: in the package we obatin that data using "load" function to get them from a rda file.</span>
HPPR &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">day.buy =</span> <span class="st">"21-09-2018"</span>, <span class="dt">day.sell =</span> <span class="st">"25-09-2018"</span>) {
  <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(<span class="kw">str_detect</span>(adj.price_df<span class="op">$</span>date, day.buy)) <span class="op">&amp;</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(<span class="kw">str_detect</span>(adj.price_df<span class="op">$</span>date, day.sell))) { <span class="co">#see whether value input existed in data</span>
    buydate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(day.buy, <span class="st">"%d-%m-%Y"</span>), <span class="st">"%Y%m%d"</span>)) <span class="co">#transform character dates into numeirc type.</span>
    selldate &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(day.sell, <span class="st">"%d-%m-%Y"</span>), <span class="st">"%Y%m%d"</span>))
    booleanpanel_<span class="dv">1</span> &lt;-<span class="st"> </span>adj.price_df<span class="op">$</span>date <span class="op">==</span><span class="st"> </span>day.buy <span class="co">#find where the date input exactly is located.</span>
    rownumber_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(booleanpanel_<span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="co">#find which row the date input exactly is located in adj.price_df.</span>
    buyprice &lt;-<span class="st"> </span>adj.price_df[rownumber_<span class="dv">1</span>, <span class="dv">2</span>] 
    booleanpanel_<span class="dv">2</span> &lt;-<span class="st"> </span>adj.price_df<span class="op">$</span>date <span class="op">==</span><span class="st"> </span>day.sell <span class="co">#find where the date input exactly is located.</span>
    rownumber_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(booleanpanel_<span class="dv">2</span> <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="co">#find which row the date input exactly is located in adj.price_df.</span>
    sellprice &lt;-<span class="st"> </span>adj.price_df[rownumber_<span class="dv">2</span>, <span class="dv">2</span>]
    <span class="cf">if</span> (buydate <span class="op">-</span><span class="st"> </span>selldate <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) { <span class="co">#Set a rule that date of buying must beofre the date of selling.</span>
      pricereturn &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(((sellprice <span class="op">-</span><span class="st"> </span>buyprice) <span class="op">/</span><span class="st"> </span>buyprice),<span class="dv">2</span>), <span class="st">"%"</span>)
      max.price &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(adj.price_df[rownumber_<span class="dv">1</span><span class="op">:</span>rownumber_<span class="dv">2</span>,<span class="dv">2</span>])
      min.price &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">min</a></span>(adj.price_df[rownumber_<span class="dv">1</span><span class="op">:</span>rownumber_<span class="dv">2</span>,<span class="dv">2</span>])
      max.return &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(((max.price <span class="op">-</span><span class="st"> </span>min.price) <span class="op">/</span><span class="st"> </span>min.price), <span class="dv">2</span>)
      sd.price &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(adj.price_df[rownumber_<span class="dv">1</span><span class="op">:</span>rownumber_<span class="dv">2</span>,<span class="dv">2</span>])
      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(pricereturn, max.price, min.price, max.return, sd.price))
    } <span class="cf">else</span> {
      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Buyday is later than sellday!"</span>)
    }
  } <span class="cf">else</span> {
    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Date input error: stock trading is closed on that day."</span>)
  }
}
<span class="kw">kable</span>(<span class="kw"><a href="../reference/HPPR.html">HPPR</a></span>(<span class="dt">day.buy =</span> <span class="st">"21-09-2018"</span>, <span class="dt">day.sell =</span> <span class="st">"27-09-2018"</span>)) <span class="co">#an example</span></code></pre></div>
<pre><code>##   pricereturn max.price min.price max.return sd.price
## 1      0.03 %  224.1678  216.9032       0.03 2.653011</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">pricereturn</th>
<th align="right">max.price</th>
<th align="right">min.price</th>
<th align="right">max.return</th>
<th align="right">sd.price</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">0.03 %</td>
<td align="right">224.1678</td>
<td align="right">216.9032</td>
<td align="right">0.03</td>
<td align="right">2.653011</td>
</tr></tbody>
</table>
<p>In the example above, pricereturn is the return gained by selling the stocks. max.price is the highest price between the buying day and the selling day, min.price is the lowest price during this period. max.return is the highest returns that a investors can get during this period if he buy stocks at the lowest price and sell it at the highest price during this period. sd.price is the standard deviation of price during this period.</p>
</div>
<div id="tdpr" class="section level4">
<h4 class="hasAnchor">
<a href="#tdpr" class="anchor"></a>TDPR</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># function_2</span>
## Trading Day Price Return Function
<span class="co">#We are not using "load" function here as we can directly extract data from adj.price_df above, this process of obtaining data is a little bit different from the function in the package: in the package we obatin that data using "load" function to get them from a rda file.</span>
TDPR &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">base.day =</span> <span class="st">"22-09-2015"</span>, <span class="dt">trading.day =</span> <span class="dv">30</span>) {
  <span class="cf">if</span> (base.day <span class="op">%in%</span><span class="st"> </span>adj.price_df<span class="op">$</span>date) {
    <span class="cf">if</span> (trading.day<span class="op">%%</span><span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {
      <span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(trading.day) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
        booleanpanel_<span class="dv">3</span> &lt;-<span class="st"> </span>adj.price_df<span class="op">$</span>date <span class="op">==</span><span class="st"> </span>base.day <span class="co">#find where the date input exactly is located.</span>
        rownumber_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(booleanpanel_<span class="dv">3</span> <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="co">#find which row the date input exactly is located in adj.price_df.</span>
        <span class="cf">if</span> (rownumber_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>trading.day <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>rownumber_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>trading.day <span class="op">&lt;=</span><span class="st"> </span><span class="dv">3016</span>) {
          tradingprice &lt;-<span class="st"> </span>adj.price_df[rownumber_<span class="dv">3</span> <span class="op">-</span><span class="st"> </span>trading.day, <span class="dv">2</span>]
          baseprice &lt;-<span class="st"> </span>adj.price_df[rownumber_<span class="dv">3</span>, <span class="dv">2</span>]
          <span class="cf">if</span> (trading.day <span class="op">&gt;</span><span class="st"> </span>base.day) {
            pricereturn2 &lt;-<span class="st"> </span>((tradingprice <span class="op">-</span><span class="st"> </span>baseprice) <span class="op">/</span><span class="st"> </span>baseprice)
            <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">100</span><span class="op">*</span>pricereturn2, <span class="dv">2</span>), <span class="st">"%"</span>, <span class="dt">sep=</span><span class="st">""</span>)
          } <span class="cf">else</span> {
             pricereturn3 &lt;-<span class="st"> </span>((baseprice <span class="op">-</span><span class="st"> </span>tradingprice) <span class="op">/</span><span class="st"> </span>tradingprice)
              <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(<span class="dv">100</span><span class="op">*</span>pricereturn3, <span class="dv">2</span>), <span class="st">"%"</span>, <span class="dt">sep=</span><span class="st">""</span>)
          }
        } <span class="cf">else</span> {
          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Error: Trading day beyond the time span of this data"</span>)
        }
      } <span class="cf">else</span> {
        <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Error: You should input a trading day different from 0"</span>)
      }
    } <span class="cf">else</span> {
      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Error: trading.day must be a integer!"</span>)
    }
  } <span class="cf">else</span> {
    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(<span class="st">"Error: Check whether the base.day input is in adj.price_df."</span>)
  }
}
<span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="dt">base.day =</span> <span class="st">"22-09-2015"</span>, <span class="dt">trading.day =</span> <span class="dv">40</span>) </code></pre></div>
<pre><code>## [1] "0.68%"</code></pre>
</div>
</div>
</div>
<div id="data-package-productreturn" class="section level2">
<h2 class="hasAnchor">
<a href="#data-package-productreturn" class="anchor"></a>Data package: productreturn</h2>
<div id="aapls-stock-returns-before-and-after-new-product-launch-events" class="section level3">
<h3 class="hasAnchor">
<a href="#aapls-stock-returns-before-and-after-new-product-launch-events" class="anchor"></a>AAPL’s stock returns before and after new product launch events</h3>
<p>Now we come to the part to use all the things above to create our final dataset, productreturn. This dataset shows the trend of AAPL stock returns before and after iphone and ios launch events. This is interesting because using this dataset, we can have a look of the trend of market reactions to these new launches. For example, we see a drastic drop of stock prices 1 day before the launches, and a slow going up of returns during the following 2 months after the new launches. What is more, market’s reaction mechnism is also different to iphone4’s launching event and iphone XR’s launching event.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Calculate the price of AAPL stocks in the day of their products launching events, based on the date given by wiki above.
check_existence_<span class="dv">1</span> &lt;-<span class="st"> "29-06-2007"</span> <span class="op">==</span><span class="st"> </span>adj.price_df<span class="op">$</span>date
location_check_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(check_existence_<span class="dv">1</span> <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)
launchprice_<span class="dv">1</span> &lt;-<span class="st"> </span>adj.price_df[location_check_<span class="dv">1</span>, <span class="dv">2</span>]

<span class="cf">for</span>(i <span class="cf">in</span> product_version<span class="op">$</span>Release_date[<span class="op">-</span><span class="dv">1</span>]) {
  check_existence &lt;-<span class="st"> </span>i <span class="op">==</span><span class="st"> </span>adj.price_df<span class="op">$</span>date
  location_check &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(check_existence <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>)
  launchprice &lt;-<span class="st"> </span>adj.price_df[location_check, <span class="dv">2</span>]
  launchprice_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(launchprice_<span class="dv">1</span>, launchprice)
}
launchprice_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(launchprice_<span class="dv">1</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/row.names">row.names</a></span>(launchprice_<span class="dv">1</span>) &lt;-<span class="st"> </span><span class="ot">NULL</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(launchprice_<span class="dv">1</span>) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"launch stock price"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate a price_performance matrix using the function we created above.
return1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="op">-</span><span class="dv">42</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="op">-</span><span class="dv">21</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="op">-</span><span class="dv">5</span>), 
                 <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="op">-</span><span class="dv">1</span>), <span class="st">"0%"</span>, <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="dv">1</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="dv">5</span>), 
                 <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="dv">21</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(<span class="st">"29-06-2007"</span>, <span class="dv">42</span>))
<span class="cf">for</span> (i <span class="cf">in</span> product_version<span class="op">$</span>Release_date[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">7</span>, <span class="op">-</span><span class="dv">16</span>, <span class="op">-</span><span class="dv">24</span>)]) {
  return &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(<span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="op">-</span><span class="dv">42</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="op">-</span><span class="dv">21</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="op">-</span><span class="dv">5</span>), 
                 <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="op">-</span><span class="dv">1</span>), <span class="st">"0%"</span>, <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="dv">1</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="dv">5</span>), 
                 <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="dv">21</span>), <span class="kw"><a href="../reference/TDPR.html">TDPR</a></span>(i, <span class="dv">42</span>))
  return1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(return1, return)
}
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(return1) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"-2 months"</span>, <span class="st">"-1 month"</span>, <span class="st">"-1 week"</span>, <span class="st">"-1 days"</span>,<span class="st">"launchday"</span>, <span class="st">"1 days"</span>, <span class="st">"1 week"</span>, <span class="st">"1 month"</span>, <span class="st">"2 months"</span>)
return1 &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(return1)
price_at_launch &lt;-<span class="st"> </span>launchprice_<span class="dv">1</span>[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">7</span>, <span class="op">-</span><span class="dv">16</span>, <span class="op">-</span><span class="dv">24</span>), ]
price_performance &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(product_version[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">7</span>, <span class="op">-</span><span class="dv">16</span>, <span class="op">-</span><span class="dv">24</span>), ], return1, price_at_launch)

## Using SQL to extract other useful information in price_df
intraday_data &lt;-<span class="st"> </span>price_df[,<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]
intraday_data<span class="op">$</span>data.date&lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(intraday_data<span class="op">$</span>data.date, <span class="st">"%Y-%m-%d"</span>), <span class="st">"%d-%m-%Y"</span>)
ordernumber &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(intraday_data)<span class="op">:</span><span class="dv">1</span>)
intraday_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(ordernumber, intraday_data)

<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(intraday_data) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ordernumber"</span>, <span class="st">"data_date"</span>, <span class="st">"data_open"</span>, <span class="st">"data_high"</span>, <span class="st">"data_low"</span>, <span class="st">"data_close"</span>, <span class="st">"data_volume"</span>)
intraday_data &lt;-<span class="st"> </span><span class="kw">sqldf</span>(<span class="st">"SELECT ordernumber, data_date, data_volume, data_open, data_high, data_low, data_close FROM intraday_data"</span>)
intraday_data &lt;-<span class="st"> </span><span class="kw">sqldf</span>(<span class="st">"SELECT *, round((Abs(data_close - data_low) - Abs(data_close - data_high)),2)</span>
<span class="st">                       AS TradeControl FROM intraday_data"</span>)
intraday_data &lt;-<span class="st"> </span><span class="kw">sqldf</span>(<span class="st">"SELECT *, round((data_close - data_open),2) </span>
<span class="st">                       AS MarketSentiment </span>
<span class="st">                       FROM intraday_data"</span>)
intraday_data &lt;-<span class="st"> </span><span class="kw">sqldf</span>(<span class="st">"SELECT * </span>
<span class="st">                       FROM intraday_data </span>
<span class="st">                       WHERE data_date IN ('29-06-2007', '11-07-2008', '19-06-2009', '21-06-2010', '14-10-2011', '21-09-2012',        '20-09-2013', '19-09-2014', '25-09-2015', '31-03-2016', '16-09-2016', '22-09-2017', '03-11-2017', '21-09-2018', '02-02-2010', '22-11-2010', '07-05-2012', '21-02-2014', '30-06-2014', '25-08-2016', '19-07-2017')</span>
<span class="st">                       ORDER BY ordernumber"</span>)

## Generate the final sheet
intraday_data_ios &lt;-<span class="st"> </span>intraday_data[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">16</span>, <span class="dv">18</span>), ]
intraday_data_iphone &lt;-<span class="st"> </span>intraday_data[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">4</span>, <span class="op">-</span><span class="dv">6</span>, <span class="op">-</span><span class="dv">8</span>, <span class="op">-</span><span class="dv">11</span>, <span class="op">-</span><span class="dv">12</span>, <span class="op">-</span><span class="dv">16</span>, <span class="op">-</span><span class="dv">18</span>), ]
intraday_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(intraday_data_iphone, intraday_data_ios)
intraday_data &lt;-<span class="st"> </span>intraday_data[,<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>)]

<span class="kw">kable</span>(productreturn &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(price_performance, intraday_data))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">Product</th>
<th align="left">Version</th>
<th align="left">Release_date</th>
<th align="left">-2 months</th>
<th align="left">-1 month</th>
<th align="left">-1 week</th>
<th align="left">-1 days</th>
<th align="left">launchday</th>
<th align="left">1 days</th>
<th align="left">1 week</th>
<th align="left">1 month</th>
<th align="left">2 months</th>
<th align="right">price_at_launch</th>
<th align="right">data_volume</th>
<th align="right">data_open</th>
<th align="right">data_high</th>
<th align="right">data_low</th>
<th align="right">data_close</th>
<th align="right">TradeControl</th>
<th align="right">MarketSentiment</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td align="left">iPhone</td>
<td align="left">NA</td>
<td align="left">29-06-2007</td>
<td align="left">22.69%</td>
<td align="left">0.7%</td>
<td align="left">-0.78%</td>
<td align="left">1.23%</td>
<td align="left">0%</td>
<td align="left">0.64%</td>
<td align="left">6.79%</td>
<td align="left">-7.38%</td>
<td align="left">9.87%</td>
<td align="right">15.39751</td>
<td align="right">40637106</td>
<td align="right">121.45</td>
<td align="right">124.000</td>
<td align="right">121.0900</td>
<td align="right">122.040</td>
<td align="right">-1.01</td>
<td align="right">0.59</td>
</tr>
<tr class="even">
<td>2</td>
<td align="left">iPhone</td>
<td align="left">3G</td>
<td align="left">11-07-2008</td>
<td align="left">-8.28%</td>
<td align="left">-4.55%</td>
<td align="left">1.45%</td>
<td align="left">-2.29%</td>
<td align="left">0%</td>
<td align="left">-0.75%</td>
<td align="left">-4.31%</td>
<td align="left">0.57%</td>
<td align="left">-12.15%</td>
<td align="right">21.77402</td>
<td align="right">33214614</td>
<td align="right">175.37</td>
<td align="right">177.110</td>
<td align="right">171.0000</td>
<td align="right">172.580</td>
<td align="right">-2.95</td>
<td align="right">-2.79</td>
</tr>
<tr class="odd">
<td>3</td>
<td align="left">iPhone</td>
<td align="left">3GS</td>
<td align="left">19-06-2009</td>
<td align="left">14.55%</td>
<td align="left">10.81%</td>
<td align="left">1.83%</td>
<td align="left">2.65%</td>
<td align="left">0%</td>
<td align="left">1.54%</td>
<td align="left">2.12%</td>
<td align="left">9.63%</td>
<td align="left">17.58%</td>
<td align="right">17.59787</td>
<td align="right">25780518</td>
<td align="right">138.07</td>
<td align="right">139.500</td>
<td align="right">136.9000</td>
<td align="right">139.480</td>
<td align="right">2.56</td>
<td align="right">1.41</td>
</tr>
<tr class="even">
<td>4</td>
<td align="left">iPhone</td>
<td align="left">4</td>
<td align="left">21-06-2010</td>
<td align="left">4.22%</td>
<td align="left">13.63%</td>
<td align="left">6.25%</td>
<td align="left">-1.42%</td>
<td align="left">0%</td>
<td align="left">-1.34%</td>
<td align="left">-0.69%</td>
<td align="left">6.27%</td>
<td align="left">-7.51%</td>
<td align="right">34.08673</td>
<td align="right">27731779</td>
<td align="right">277.75</td>
<td align="right">279.010</td>
<td align="right">268.7300</td>
<td align="right">270.170</td>
<td align="right">-7.40</td>
<td align="right">-7.58</td>
</tr>
<tr class="odd">
<td>5</td>
<td align="left">iPhone</td>
<td align="left">4S</td>
<td align="left">14-10-2011</td>
<td align="left">10.91%</td>
<td align="left">7.39%</td>
<td align="left">14.12%</td>
<td align="left">3.32%</td>
<td align="left">0%</td>
<td align="left">0.48%</td>
<td align="left">-6.9%</td>
<td align="left">-10.13%</td>
<td align="left">-9.91%</td>
<td align="right">53.24277</td>
<td align="right">20477390</td>
<td align="right">417.00</td>
<td align="right">422.000</td>
<td align="right">415.2700</td>
<td align="right">422.000</td>
<td align="right">6.73</td>
<td align="right">5.00</td>
</tr>
<tr class="even">
<td>6</td>
<td align="left">iPhone</td>
<td align="left">5</td>
<td align="left">21-09-2012</td>
<td align="left">17%</td>
<td align="left">4.67%</td>
<td align="left">1.28%</td>
<td align="left">0.2%</td>
<td align="left">0%</td>
<td align="left">1.35%</td>
<td align="left">-4.71%</td>
<td align="left">10.42%</td>
<td align="left">-19.4%</td>
<td align="right">88.70862</td>
<td align="right">20413868</td>
<td align="right">702.56</td>
<td align="right">705.070</td>
<td align="right">699.3617</td>
<td align="right">700.095</td>
<td align="right">-4.24</td>
<td align="right">-2.46</td>
</tr>
<tr class="odd">
<td>8</td>
<td align="left">iPhone</td>
<td align="left">5S</td>
<td align="left">20-09-2013</td>
<td align="left">12.29%</td>
<td align="left">-6.96%</td>
<td align="left">0.54%</td>
<td align="left">-1.04%</td>
<td align="left">0%</td>
<td align="left">-4.73%</td>
<td align="left">3.28%</td>
<td align="left">11.54%</td>
<td align="left">11.8%</td>
<td align="right">60.63633</td>
<td align="right">24975046</td>
<td align="right">478.50</td>
<td align="right">478.550</td>
<td align="right">466.0000</td>
<td align="right">467.410</td>
<td align="right">-9.73</td>
<td align="right">-11.09</td>
</tr>
<tr class="even">
<td>9</td>
<td align="left">iPhone</td>
<td align="left">6</td>
<td align="left">19-09-2014</td>
<td align="left">4.4%</td>
<td align="left">0.38%</td>
<td align="left">-0.69%</td>
<td align="left">-0.82%</td>
<td align="left">0%</td>
<td align="left">-0.1%</td>
<td align="left">-0.21%</td>
<td align="left">-1.19%</td>
<td align="left">14.87%</td>
<td align="right">93.75105</td>
<td align="right">70902406</td>
<td align="right">102.29</td>
<td align="right">102.350</td>
<td align="right">100.8800</td>
<td align="right">100.960</td>
<td align="right">-1.31</td>
<td align="right">-1.33</td>
</tr>
<tr class="odd">
<td>10</td>
<td align="left">iPhone</td>
<td align="left">6S</td>
<td align="left">25-09-2015</td>
<td align="left">-6.61%</td>
<td align="left">4.58%</td>
<td align="left">1.11%</td>
<td align="left">-0.25%</td>
<td align="left">0%</td>
<td align="left">2.02%</td>
<td align="left">-3.77%</td>
<td align="left">-0.49%</td>
<td align="left">4.08%</td>
<td align="right">108.34016</td>
<td align="right">56151926</td>
<td align="right">116.44</td>
<td align="right">116.690</td>
<td align="right">114.0200</td>
<td align="right">114.710</td>
<td align="right">-1.29</td>
<td align="right">-1.73</td>
</tr>
<tr class="even">
<td>11</td>
<td align="left">iPhone</td>
<td align="left">SE</td>
<td align="left">31-03-2016</td>
<td align="left">12.58%</td>
<td align="left">8.42%</td>
<td align="left">2.69%</td>
<td align="left">-0.52%</td>
<td align="left">0%</td>
<td align="left">-0.91%</td>
<td align="left">-0.41%</td>
<td align="left">16.27%</td>
<td align="left">-7.82%</td>
<td align="right">103.93938</td>
<td align="right">25888449</td>
<td align="right">109.72</td>
<td align="right">109.900</td>
<td align="right">108.8800</td>
<td align="right">108.990</td>
<td align="right">-0.80</td>
<td align="right">-0.73</td>
</tr>
<tr class="odd">
<td>12</td>
<td align="left">iPhone</td>
<td align="left">7</td>
<td align="left">16-09-2016</td>
<td align="left">15.69%</td>
<td align="left">5.22%</td>
<td align="left">11.43%</td>
<td align="left">-0.56%</td>
<td align="left">0%</td>
<td align="left">1.18%</td>
<td align="left">-1.92%</td>
<td align="left">2.29%</td>
<td align="left">-6.32%</td>
<td align="right">110.85916</td>
<td align="right">79886911</td>
<td align="right">115.12</td>
<td align="right">116.130</td>
<td align="right">114.0400</td>
<td align="right">114.920</td>
<td align="right">-0.33</td>
<td align="right">-0.20</td>
</tr>
<tr class="even">
<td>13</td>
<td align="left">iPhone</td>
<td align="left">8</td>
<td align="left">22-09-2017</td>
<td align="left">-0.17%</td>
<td align="left">-5.06%</td>
<td align="left">-5%</td>
<td align="left">-0.98%</td>
<td align="left">0%</td>
<td align="left">0.89%</td>
<td align="left">1.47%</td>
<td align="left">-2.74%</td>
<td align="left">14.4%</td>
<td align="right">149.10736</td>
<td align="right">46645443</td>
<td align="right">152.02</td>
<td align="right">152.270</td>
<td align="right">150.5600</td>
<td align="right">151.890</td>
<td align="right">0.95</td>
<td align="right">-0.13</td>
</tr>
<tr class="odd">
<td>14</td>
<td align="left">iPhone</td>
<td align="left">X</td>
<td align="left">03-11-2017</td>
<td align="left">6.54%</td>
<td align="left">11.01%</td>
<td align="left">5.8%</td>
<td align="left">2.61%</td>
<td align="left">0%</td>
<td align="left">1.01%</td>
<td align="left">1.62%</td>
<td align="left">-1.3%</td>
<td align="left">1.81%</td>
<td align="right">169.33978</td>
<td align="right">59398631</td>
<td align="right">174.00</td>
<td align="right">174.260</td>
<td align="right">171.1200</td>
<td align="right">172.500</td>
<td align="right">-0.38</td>
<td align="right">-1.50</td>
</tr>
<tr class="even">
<td>15</td>
<td align="left">iPhone</td>
<td align="left">XS</td>
<td align="left">21-09-2018</td>
<td align="left">13.17%</td>
<td align="left">1.21%</td>
<td align="left">-2.76%</td>
<td align="left">-1.08%</td>
<td align="left">0%</td>
<td align="left">-1.42%</td>
<td align="left">3.71%</td>
<td align="left">-1.36%</td>
<td align="left">-18.41%</td>
<td align="right">216.90319</td>
<td align="right">96246748</td>
<td align="right">220.78</td>
<td align="right">221.360</td>
<td align="right">217.2900</td>
<td align="right">217.660</td>
<td align="right">-3.33</td>
<td align="right">-3.12</td>
</tr>
<tr class="odd">
<td>17</td>
<td align="left">IOS</td>
<td align="left">3.1.3</td>
<td align="left">02-02-2010</td>
<td align="left">-0.19%</td>
<td align="left">-8.48%</td>
<td align="left">-4.89%</td>
<td align="left">0.58%</td>
<td align="left">0%</td>
<td align="left">1.72%</td>
<td align="left">0.17%</td>
<td align="left">7.58%</td>
<td align="left">21.77%</td>
<td align="right">24.71120</td>
<td align="right">24940759</td>
<td align="right">195.93</td>
<td align="right">196.320</td>
<td align="right">193.3800</td>
<td align="right">195.860</td>
<td align="right">2.02</td>
<td align="right">-0.07</td>
</tr>
<tr class="even">
<td>18</td>
<td align="left">IOS</td>
<td align="left">4.2.1</td>
<td align="left">22-11-2010</td>
<td align="left">8.46%</td>
<td align="left">1.92%</td>
<td align="left">2.06%</td>
<td align="left">2.16%</td>
<td align="left">0%</td>
<td align="left">1.5%</td>
<td align="left">-0.71%</td>
<td align="left">-3.63%</td>
<td align="left">7.69%</td>
<td align="right">39.53591</td>
<td align="right">14038356</td>
<td align="right">306.69</td>
<td align="right">313.360</td>
<td align="right">305.8700</td>
<td align="right">313.360</td>
<td align="right">7.49</td>
<td align="right">6.67</td>
</tr>
<tr class="odd">
<td>19</td>
<td align="left">IOS</td>
<td align="left">5.1.1</td>
<td align="left">07-05-2012</td>
<td align="left">7.31%</td>
<td align="left">-10.13%</td>
<td align="left">-2.48%</td>
<td align="left">0.75%</td>
<td align="left">0%</td>
<td align="left">-0.23%</td>
<td align="left">-1.98%</td>
<td align="left">0.35%</td>
<td align="left">6.39%</td>
<td align="right">71.84998</td>
<td align="right">16439031</td>
<td align="right">561.50</td>
<td align="right">572.770</td>
<td align="right">561.2300</td>
<td align="right">569.480</td>
<td align="right">4.96</td>
<td align="right">7.98</td>
</tr>
<tr class="even">
<td>20</td>
<td align="left">IOS</td>
<td align="left">6.1.6</td>
<td align="left">21-02-2014</td>
<td align="left">-2.95%</td>
<td align="left">-4.19%</td>
<td align="left">-3.52%</td>
<td align="left">-1.11%</td>
<td align="left">0%</td>
<td align="left">-0.44%</td>
<td align="left">0.19%</td>
<td align="left">-2.59%</td>
<td align="left">-0.1%</td>
<td align="right">68.94790</td>
<td align="right">9965321</td>
<td align="right">532.72</td>
<td align="right">534.570</td>
<td align="right">524.6000</td>
<td align="right">525.250</td>
<td align="right">-8.67</td>
<td align="right">-7.47</td>
</tr>
<tr class="odd">
<td>21</td>
<td align="left">IOS</td>
<td align="left">7.1.2</td>
<td align="left">30-06-2014</td>
<td align="left">10.85%</td>
<td align="left">2.77%</td>
<td align="left">2.31%</td>
<td align="left">1.03%</td>
<td align="left">0%</td>
<td align="left">-0.63%</td>
<td align="left">2.6%</td>
<td align="left">-5.32%</td>
<td align="left">10.58%</td>
<td align="right">85.86732</td>
<td align="right">49589028</td>
<td align="right">92.16</td>
<td align="right">93.725</td>
<td align="right">92.0900</td>
<td align="right">92.930</td>
<td align="right">0.05</td>
<td align="right">0.77</td>
</tr>
<tr class="even">
<td>22</td>
<td align="left">IOS</td>
<td align="left">9.3.5</td>
<td align="left">25-08-2016</td>
<td align="left">17.51%</td>
<td align="left">5.05%</td>
<td align="left">-1.38%</td>
<td align="left">-0.43%</td>
<td align="left">0%</td>
<td align="left">0.59%</td>
<td align="left">-0.78%</td>
<td align="left">-4.7%</td>
<td align="left">9.93%</td>
<td align="right">103.76888</td>
<td align="right">25086248</td>
<td align="right">107.39</td>
<td align="right">107.880</td>
<td align="right">106.6800</td>
<td align="right">107.570</td>
<td align="right">0.58</td>
<td align="right">0.18</td>
</tr>
<tr class="odd">
<td>23</td>
<td align="left">IOS</td>
<td align="left">10.3.3</td>
<td align="left">19-07-2017</td>
<td align="left">-1%</td>
<td align="left">3.2%</td>
<td align="left">3.62%</td>
<td align="left">0.63%</td>
<td align="left">0%</td>
<td align="left">0.45%</td>
<td align="left">1.62%</td>
<td align="left">4.94%</td>
<td align="left">5.48%</td>
<td align="right">147.67339</td>
<td align="right">20922969</td>
<td align="right">150.48</td>
<td align="right">151.420</td>
<td align="right">149.9500</td>
<td align="right">151.020</td>
<td align="right">0.67</td>
<td align="right">0.54</td>
</tr>
</tbody>
</table>
<p>From the chart above we find that most iPhone and ios launches have resulted in positive price performance 2 months after launch. Those iPhone which does not have a good performance indicates that investors’ expections are not met. The price 1 day before new launches always drop, which make sense as what we experience in life: bad news are always released before iPhone’s launch events by its competitors, and markets always overreflect to that message.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#data-package-adj-price_df">Data package: adj.price_df</a></li>
      <li><a href="#function-packages-hppr-and-tdpr">function packages: HPPR and TDPR</a></li>
      <li><a href="#data-package-productreturn">Data package: productreturn</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Suxu Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
